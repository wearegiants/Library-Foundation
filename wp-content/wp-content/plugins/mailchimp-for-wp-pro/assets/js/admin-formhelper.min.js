!function(a){"use strict";function b(){"undefined"!=typeof QTags&&(QTags.addButton("mc4wp_paragraph","<p>","<p>","</p>","paragraph","Paragraph tag",1),QTags.addButton("mc4wp_label","label","<label>","</label>","label","Label tag",2),QTags.addButton("mc4wp_response","form response","{response}","","response","Shows the form response"),QTags.addButton("mc4wp_subscriber_count","# of subscribers","{subscriber_count}","","subscribers","Shows number of subscribers of selected list(s)"),1==window.mc4wp.has_captcha_plugin&&QTags.addButton("mc4wp_captcha","CAPTCHA","{captcha}","","captcha","Display a CAPTCHA field"))}function c(b){var c=b.keyCode||b.which;if(9==c){b.preventDefault();var d=this.selectionStart,e=this.selectionEnd;a(this).val(a(this).val().substring(0,d)+"	"+a(this).val().substring(e)),this.selectionStart=this.selectionEnd=d+1}}var d=a(document.getElementById("content")),e=a(document.getElementById("missing-fields-notice")),f=a(document.getElementById("missing-fields-list"));a(document).delegate("#content","keydown",c),b(),function(){function b(){f.is(":checked")?e.hide():e.text("Select at least 1 list this form should subscribe people to.").show()}function c(b,c,d){var e=""===a(b).val()?a(b).data("inherited-value"):a(b).val(),f=1==e==d;f?a("#mc4wp-"+c).removeClass("hidden").find(":input").removeAttr("disabled"):a("#mc4wp-"+c).addClass("hidden").find(":input").attr("disabled","disabled")}var d=a(document.getElementById("mc4wp-form-settings")),e=d.find(".mc4wp-notice"),f=a(document.getElementById("mc4wp-lists")).find(":input"),g=a("input[name='mc4wp_form[double_optin]']"),h=a('input[name="mc4wp_form[update_existing]"]');f.change(b),g.change(function(){c(this,"send-welcome",!1)}),h.change(function(){c(this,"replace-interests",!0)}),a('#mc4wp-optional-settings input[name="mc4wp_form[send_email_copy]"]').change(function(){a("#email_copy_receiver").toggle(1==a(this).val())}),b()}(),function(){function b(){for(var b={},c=0;c<G.length;c++){var g='name="'+G[c].tag.toLowerCase();-1==d.val().toLowerCase().indexOf(g)&&(b[G[c].tag]=G[c])}if(a.isEmptyObject(b))return void e.hide();f.html("");for(var h in b){var i=b[h],j=a("<li />");j.html(i.name+" (<code>"+i.tag+"</code>)"),j.appendTo(f)}e.show()}function c(){t.find("option").not(".default").remove(),G=[],s.filter(":checked").each(function(){for(var b=a(this).val(),c=mc4wp.mailchimpLists[b],d=0,e=c.merge_vars.length;e>d;d++){var f=c.merge_vars[d];if(f.req&&G.push(f),0==u.find("option[value='"+f.tag+"']").length){var g=f.name.length>25?f.name.substring(0,25)+"..":f.name;f.req&&(g+="*");var h=a("<option />").text(g).val(f.tag).data("list-field",f);u.append(h)}}for(var d=0,i=c.interest_groupings.length;i>d;d++){var j=c.interest_groupings[d];if(0==v.find("option[value='"+j.id+"']").length){var g=j.name.length>25?j.name.substring(0,25)+"..":j.name,h=a("<option />").text(g).val(j.id).data("list-grouping",j);v.append(h)}}}),b()}function g(){h();var b=a(this).find(":selected");switch(b.val()){case"submit":q="submit",y.text(F.buttonText),x.val(F.subscribe),w.find("p.row").filter(".value, .wrap-p").show();break;case"lists":q="lists",w.find(".wrap-p").show();break;default:var c=b.data("list-field");if(c)return l(c);var c=b.data("list-grouping");if(c)return j(c)}n()}function h(){w.find(".row :input").each(function(){a(this).is(":checkbox")?this.checked=!0:this.value=""}),w.find("p.row").hide(),z.find(":input").remove(),w.show(),q="text",r="",y.html(F.initialValue+" <small>"+F.optional+"</small>")}function i(b){for(var c=0,d=b.length;d>c;c++)a("<input />").attr("type","text").addClass("widefat").data("value",b[c].name).attr("placeholder",F.labelFor+' "'+b[c].name+'" '+F.orLeaveEmpty).attr("value",b[c].name).appendTo(z)}function j(a){switch(w.find("p.row").filter(".values, .label, .wrap-p").show(),A.val(a.name+":"),r="GROUPINGS["+a.id+"]",i(a.groups),a.form_field){case"radio":q="radio";break;case"hidden":w.find("p.row").filter(".values, .label, .wrap-p").hide(),w.find("p.row.value").show();for(var b=0,c=a.groups.length;c>b;b++)x.val(x.val()+a.groups[b].name+",");q="hidden";break;case"dropdown":q="select";break;default:q="checkbox",r+="[]"}n()}function k(){var b="";return s.each(function(){var c=a(this).val(),d=a(this).parent("label").text(),e="";a(this).is(":checked")&&(e+="checked "),b+="<label>\n",b+='	<input type="checkbox" name="_mc4wp_lists[]" value="'+c+'" '+e+" /> "+d+"\n",b+="</label>\n"}),b}function l(b){var c={"default":["label","value","placeholder","required","wrap-p"],select:["label","required","wrap-p","values"],radio:["label","required","wrap-p","values"],date:["label","required","wrap-p","value"]},d={text:"text",email:"email",phone:"tel",address:"text",number:"number",dropdown:"select",date:"date",birthday:"date",radio:"radio",checkbox:"checkbox"};if(q=void 0!=d[b.field_type]?d[b.field_type]:"text",void 0!=c[q])var e=c[q];else var e=c["default"];for(var f=0,g=e.length;g>f;f++)w.find("p.row."+e[f]).show();if(q=q,r=b.tag,B.val("Your "+b.name.toLowerCase()),A.val(b.name+":"),C.prop("checked",b.req),z.is(":visible")&&b.choices)for(var f=0,g=b.choices.length;g>f;f++)a("<input />").attr("type","text").addClass("widefat").data("value",b.choices[f]).attr("placeholder",F.labelFor+' "'+b.choices[f]+'" '+F.orLeaveEmpty).attr("value",b.choices[f]).appendTo(z);n()}function m(a){a=html_beautify(a),E.val(a)}function n(){var b,c=a("<div></div>"),d="";switch(q){case"lists":return d=k(),p()&&(d="<p>"+d+"</p>"),m(d);case"select":b=a("<select />"),z.find(":input").each(function(){a(this).val().length>0&&a("<option />").val(a(this).data("value")).text(a(this).val()).appendTo(b)});break;case"radio":case"checkbox":z.find(":input").each(function(){a(this).val().length>0&&(b=a("<input />").attr("type",q).attr("name",r).val(a(this).data("value")),C.is(":visible:checked")&&b.attr("required",!0),c.append(b),b.wrap("<label />"),a("<span />").text(a(this).val()+" ").insertAfter(b))});break;case"textarea":b=a("<textarea />");break;default:b=a("<input />").attr("type",q)}"radio"!=q&&"checkbox"!=q&&(r.length>0&&b.attr("name",r),x.is(":visible")&&x.val().length>0&&("textarea"==q?b.text(x.val()):b.attr("value",x.val())),B.is(":visible")&&B.val().length>0&&b.attr("placeholder",B.val()),C.is(":visible:checked")&&b.attr("required",!0),c.append(b)),A.is(":visible")&&A.val().length>0&&a("<label />").text(A.val()).prependTo(c),p()&&c.wrapInner(a("<p />")),d=c.html(),m(d)}function o(){var a=!1;"undefined"!=typeof wpActiveEditor&&"undefined"!=typeof QTags&&QTags.insertContent&&(a=QTags.insertContent(E.val())),a||d.val(d.val()+"\n"+E.val()),d.change()}function p(){return D.is(":visible:checked")?!0:!1}var q,r,s=a("#mc4wp-lists input"),t=a("#mc4wp-fw-mailchimp-fields"),u=t.find(".merge-fields"),v=t.find(".groupings"),w=a("#mc4wp-fw-fields"),x=a("#mc4wp-fw-value"),y=a("#mc4wp-fw-value-label"),z=a("#mc4wp-fw-values"),A=a("#mc4wp-fw-label"),B=a("#mc4wp-fw-placeholder"),C=a("#mc4wp-fw-required"),D=a("#mc4wp-fw-wrap-p"),E=a("#mc4wp-fw-preview"),F=mc4wp.strings.fieldWizard,G=[];s.change(c),t.change(g),w.change(n),a("#mc4wp-fw-add-to-form").click(o),d.bind({input:function(){d.unbind("keydown"),b.call(this)},keydown:b}),c()}()}(jQuery);