jQuery(document).ready(function(a){function b(b,f){"undefined"==typeof f&&(f=!1);var g=!0,h=[],i=b.find(".bundle_data").data("bundle_price_data");if(b.find(".bundled_product").each(function(){var c=a(this).find(".cart"),d=c.attr("data-bundled-item-id");return i.optional_status[d]=parseFloat(1==c.data("optional")&&0==c.data("optional_status")?0:1),"variable"==c.data("type")&&""==c.find('.bundled_item_wrap input[name="variation_id"]').val()&&(b.find(".bundle_data .bundle_wrap").find("input.bundle_variation_id_"+d).val(""),i.prices[d]=0,i.regular_prices[d]=0,0==c.data("optional")||1==c.data("optional_status"))?(g=!1,!1):void 0}),g){b.find(".bundled_product .cart").each(function(){var b=a(this),c=a(this).attr("data-bundled-item-id");h[c]=0,b.find(".addon").each(function(){var b=0;a(this).is(".addon-custom-price")?b=a(this).val():a(this).is(".addon-input_multiplier")?(isNaN(a(this).val())||""==a(this).val()?(a(this).val(""),a(this).closest("p").find(".addon-alert").show()):(""!=a(this).val()&&a(this).val(Math.ceil(a(this).val())),a(this).closest("p").find(".addon-alert").hide()),b=a(this).data("price")*a(this).val()):a(this).is(".addon-checkbox, .addon-radio")?a(this).is(":checked")&&(b=a(this).data("price")):a(this).is(".addon-select")?a(this).val()&&(b=a(this).find("option:selected").data("price")):a(this).val()&&(b=a(this).data("price")),b||(b=0),h[c]=parseFloat(h[c])+parseFloat(b)})});var j=b.find(".bundle_data").data("bundled_item_quantities");if(0==i.per_product_pricing&&""===i.total)return void c(b,wc_bundle_params.i18n_unavailable_text);if(1==i.per_product_pricing){i.total=0,i.regular_total=0;for(var k in i.prices)i.total+=(parseFloat(i.prices[k])+parseFloat(h[k]))*j[k]*i.optional_status[k],i.regular_total+=(parseFloat(i.regular_prices[k])+parseFloat(h[k]))*j[k]*i.optional_status[k]}else{i.total_backup=parseFloat(i.total),i.regular_total_backup=parseFloat(i.regular_total);for(var l in h)i.total+=parseFloat(h[l])*j[l]*i.optional_status[l],i.regular_total+=parseFloat(h[l])*j[l]*i.optional_status[l]}var m=b.find(".bundle_data #product-addons-total");if(m.length>0&&(m.data("price",i.total),b.find(".bundle_data").trigger("woocommerce-product-addons-update")),1==i.bundle_is_composited&&(wc_bundle_params.i18n_total=""),0==i.total)b.find(".bundle_data .bundle_price").html(0==i.bundle_is_composited?'<p class="price"><span class="total">'+wc_bundle_params.i18n_total+"</span>"+wc_bundle_params.i18n_free+"</p>":"");else{var n=d(e(i.total)),o=d(e(i.regular_total));b.find(".bundle_data .bundle_price").html(i.regular_total>i.total?'<p class="price">'+i.price_string.replace("%s",'<span class="total">'+wc_bundle_params.i18n_total+"</span><del>"+o+"</del> <ins>"+n+"</ins>")+"</p>":'<p class="price">'+i.price_string.replace("%s",'<span class="total">'+wc_bundle_params.i18n_total+"</span>"+n)+"</p>")}b.find(".bundle_data .bundle_wrap p.stock").replaceWith(b.find(".bundle_data").data("stock_status")),b.find(".bundled_product .cart").each(function(){if(1==a(this).data("optional")&&0==a(this).data("optional_status"))return!0;var c=a(this).find("p.stock");c.hasClass("out-of-stock")&&(b.find(".bundle_data .bundle_wrap p.stock").length>0?b.find(".bundle_data .bundle_wrap p.stock").replaceWith(c.clone().html(wc_bundle_params.i18n_partially_out_of_stock)):b.find(".bundle_data .bundle_wrap .bundle_price").after(c.clone().html(wc_bundle_params.i18n_partially_out_of_stock))),c.hasClass("available-on-backorder")&&!b.find(".bundle_data .bundle_wrap p.stock").hasClass("out-of-stock")&&(b.find(".bundle_data .bundle_wrap p.stock").length>0?b.find(".bundle_data .bundle_wrap p.stock").replaceWith(c.clone().html(wc_bundle_params.i18n_partially_on_backorder)):b.find(".bundle_data .bundle_wrap .bundle_price").after(c.clone().html(wc_bundle_params.i18n_partially_on_backorder)))}),b.find(".bundle_data .bundle_wrap p.stock").hasClass("out-of-stock")?b.find(".bundle_data .bundle_button button").prop("disabled",!0).addClass("disabled"):b.find(".bundle_data .bundle_button button").prop("disabled",!1).removeClass("disabled");var p=b.find(".bundle_data").data("button_behaviour");"new"!==p&&b.find(".bundle_data .bundle_wrap").slideDown(200),b.find(".bundle_data .bundle_wrap").trigger("woocommerce-product-bundle-show",b.find(".bundle_data").data("bundle-id")),b.find(".component_data").data("price",i.total),b.find(".component_data").data("regular_price",i.regular_total),b.find(".component_data").data("component_set",!0),i.total=i.total_backup,i.regular_total=i.regular_total_backup}else f||c(b);b.find(".bundle_data .bundle_wrap").trigger("woocommerce-composited-product-update")}function c(a,b){"undefined"==typeof b&&(b=wc_bundle_params.i18n_select_options),a.find(".component_data").data("component_set",!1);var c=a.find(".bundle_data").data("button_behaviour");"new"==c?(a.find(".bundle_data .bundle_price").html(b),a.find(".bundle_data .bundle_button button").prop("disabled",!0).addClass("disabled")):a.find(".bundle_data .bundle_wrap").slideUp(200),a.find(".bundle_data .bundle_wrap").trigger("woocommerce-product-bundle-hide",a.find(".bundle_data").data("bundle-id"))}function d(a){var b=wc_bundle_params.currency_format_decimal_sep,c=wc_bundle_params.currency_position,d=wc_bundle_params.currency_symbol,e=wc_bundle_params.currency_format_trim_zeros,f=wc_bundle_params.currency_format_num_decimals;if("yes"==e&&f>0){for(var g=0;f>g;g++)b+="0";a=a.replace(b,"")}var h="";return"left"==c?h='<span class="amount">'+d+a+"</span>":"right"==c?h='<span class="amount">'+a+d+"</span>":"left_space"==c?h='<span class="amount">'+d+"&nbsp;"+a+"</span>":"right_space"==c&&(h='<span class="amount">'+a+"&nbsp;"+d+"</span>"),h}function e(a){var b=wc_bundle_params.currency_format_num_decimals,c=wc_bundle_params.currency_format_decimal_sep,d=wc_bundle_params.currency_format_thousand_sep,e=a,f=isNaN(b=Math.abs(b))?2:b,g=void 0==c?",":c,h=void 0==d?".":d,i=0>e?"-":"",j=parseInt(e=Math.abs(+e||0).toFixed(f))+"",k=(k=j.length)>3?k%3:0;return i+(k?j.substr(0,k)+h:"")+j.substr(k).replace(/(\d{3})(?=\d)/g,"$1"+h)+(f?g+Math.abs(e-j).toFixed(f).slice(2):"")}a("body").on("quick-view-displayed",function(){a(".bundle_form .bundle_data").each(function(){a(this).wc_pb_bundle_form()})}),a.fn.wc_pb_bundle_form=function(){a(".bundled_product").on("change",".bundled_product_optional_checkbox input",function(c){var d=a(this).closest(".bundle_form");a(this).is(":checked")?(a(this).closest(".bundled_product").find(".bundled_item_optional_content").slideDown(200),a(this).closest(".bundled_product").find(".cart").data("optional_status",!0)):(a(this).closest(".bundled_product").find(".bundled_item_optional_content").slideUp(200),a(this).closest(".bundled_product").find(".cart").data("optional_status",!1)),b(d),c.stopPropagation()}).on("found_variation",function(c,d){var e=a(this).find(".variations_form"),f=e.closest(".bundle_form"),g=e.attr("data-bundled-item-id"),h=f.find(".bundle_data").data("bundle_price_data");1==h.per_product_pricing&&(h.prices[g]=d.price,h.regular_prices[g]=d.regular_price),f.find(".bundle_data .bundle_wrap").find("input.bundle_variation_id_"+g).val(d.variation_id).change();for(var i in d.attributes)f.find(".bundle_data .bundle_wrap").find("input.bundle_"+i+"_"+g).val(e.find('select[name="'+i+'"]').val());b(f),c.stopPropagation()}).on("woocommerce-product-addons-update",function(a){a.stopPropagation()}).on("woocommerce_variation_select_focusin",function(a){a.stopPropagation()}).on("woocommerce_variation_select_change",function(a){a.stopPropagation()}).on("woocommerce_update_variation_values",function(c){var d=a(this).find(".variations_form"),e=d.closest(".bundle_form");b(e),c.stopPropagation()}),a(".bundled_product .cart").on("woocommerce-product-addons-update",function(c){var d=a(this).closest(".cart"),e=d.closest(".bundle_form");b(e,!0),c.stopPropagation()}).on("woocommerce-nyp-updated-item",function(c){var d=a(this),e=d.closest(".bundle_form"),f=d.attr("data-bundled-item-id"),g=d.find(".nyp");if(g.is(":visible")){var h=e.find(".bundle_data").data("bundle_price_data");h.prices[f]=g.data("price"),b(e)}c.stopPropagation()}),a(".bundle_data").on("woocommerce-nyp-updated-item",function(c){var d=a(this),e=d.closest(".bundle_form"),f=d.find(".nyp");if(f.is(":visible")){var g=e.find(".bundle_data").data("bundle_price_data");g.total=f.data("price"),b(e)}c.stopPropagation()});var c=a(this).find("#product-addons-total");a(this).find(".bundle_price").after(c),a(this).find(".bundle_wrap p.stock").length>0&&this.data("stock_status",a(this).find(".bundle_wrap p.stock").clone().wrap("<p>").parent().html()),a(this).parent().find(".bundled_product").each(function(){var b=a(this).find(".cart");a(this).find(".bundled_product_optional_checkbox input").change(),"variable"!=b.data("type")||b.hasClass("variations_form")||(b.addClass("variations_form").wc_variation_form(),b.find(".variations select").change())}),b(a(this).closest(".bundle_form"))},a(".bundle_form .bundle_data").each(function(){a(this).wc_pb_bundle_form()})});