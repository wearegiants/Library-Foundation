(function(){jQuery(document).ready(function(a){"use strict";var b;return b=a("form[name='checkout']"),a("form[name='checkout']").attr("id","checkout").addClass("dropzone"),b.find(":input.select").each(function(){var b,c,d;return b=a(this).closest(".form-row").hasClass("validate-required"),"function"==typeof(c=a(this)).select2&&c.select2({allowClear:!b,placeholder:a(this).attr("multiple")?wc_checkout_add_ons.chosen_placeholder_multi:wc_checkout_add_ons.chosen_placeholder_single}),a().select2?void 0:"function"==typeof(d=a(this)).chosen?d.chosen({allow_single_deselect:!b,placeholder_text_single:wc_checkout_add_ons.chosen_placeholder_single,placeholder_text_multiple:wc_checkout_add_ons.chosen_placeholder_multi,no_results_text:wc_checkout_add_ons.chosen_no_results_text}):void 0}),a(function(){return a("#wc_checkout_add_ons *").on("change",function(){return a("input[type='file']").each(function(){var b;return b=a(this).val(),b?a(this).next().val("1"):void 0}),a("body").trigger("update_checkout")}),a("#wc_checkout_add_ons input[type='radio']").on("click",function(){var b;return(b=a(this).closest(".form-row").hasClass("validate-required"))?void 0:a(this).data("prev-value")?a(this).removeAttr("checked").data("prev-value",!1).trigger("change"):a(this).data("prev-value",a(this).is(":checked"))}),a("#wc_checkout_add_ons .input-file-plupload").each(function(){var b,c,d,e,f,g,h,i,j;return g=a(this),b=g.find(".dropzone"),e=g.find(".preview"),f=g.find(".progress"),c=g.find(".feedback"),d=g.find('input[type="hidden"]'),h=g.parents(".form-row").prop("id"),i={url:wc_checkout_add_ons.ajax_url,multipart_params:{action:"wc_checkout_add_on_upload_file",security:wc_checkout_add_ons.upload_nonce,field:h},browse_button:b[0],drop_element:b[0],multi_selection:wc_checkout_add_ons.max_files>1,filters:{max_file_size:wc_checkout_add_ons.max_file_size}},j=new plupload.Uploader(i),j.init(),j.bind("Error",function(a,b){return c.html("\nError #"+b.code+": "+b.message).removeClass("hide"),f.addClass("hide")}),j.bind("FilesAdded",function(){return c.html("").addClass("hide"),b.addClass("disabled"),f.removeClass("hide"),j.start()}),j.bind("UploadProgress",function(a,b){return f.find(".bar").css("width",b.percent+"%")}),j.bind("FileUploaded",function(h,i,j){var k;return k=a.parseJSON(j.response),k.errors?(c.html(k.errors.upload_error).removeClass("hide"),f.addClass("hide"),void b.removeClass("disabled")):(d.val(k.id).trigger("change"),e.removeClass("hide").find("a.file").prop("href",k.url).text(k.title),b.addClass("hide").removeClass("disabled"),f.addClass("hide").find(".bar").css("width",0),g.find(".moxie-shim").addClass("hide"))}),g.find("a.remove-file").on("click",function(c){return c.preventDefault(),e.addClass("hide"),b.removeClass("hide disabled"),a.ajax({type:"POST",url:wc_checkout_add_ons.ajax_url,data:{action:"wc_checkout_add_on_remove_file",security:wc_checkout_add_ons.remove_nonce,file:d.val()}}),d.val("").trigger("change"),g.find(".moxie-shim").removeClass("hide")})})})})}).call(this);
