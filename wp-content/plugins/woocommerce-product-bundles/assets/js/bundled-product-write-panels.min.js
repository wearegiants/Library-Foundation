jQuery(function(a){function b(){a(".wc-bundled-items .wc-bundled-item").each(function(b,c){a(".bundled_item_position",c).val(parseInt(a(c).index(".wc-bundled-items .wc-bundled-item")))})}function c(){a(".filter_variations input").change(function(){a(this).is(":checked")?a(this).closest("div.item-data").find("div.bundle_variation_filters").show():a(this).closest("div.item-data").find("div.bundle_variation_filters").hide()}).change(),a(".override_defaults input").change(function(){a(this).is(":checked")?a(this).closest("div.item-data").find("div.bundle_selection_defaults").show():a(this).closest("div.item-data").find("div.bundle_selection_defaults").hide()}).change(),a(".override_title > p input").change(function(){a(this).is(":checked")?a(this).closest("div.item-data").find("div.custom_title").show():a(this).closest("div.item-data").find("div.custom_title").hide()}).change(),a(".override_description > p input").change(function(){a(this).is(":checked")?a(this).closest("div.item-data").find("div.custom_description").show():a(this).closest("div.item-data").find("div.custom_description").hide()}).change(),a(".item_visibility select").change(function(){"visible"==a(this).val()?(a(this).closest("div.item-data").find(".override_title, .override_description, .images").show(),a(this).closest("div.item-data").find(".override_title > p input").change(),a(this).closest("div.item-data").find(".override_description > p input").change()):a(this).closest("div.item-data").find(".override_title, .custom_title, .override_description, .custom_description, .images").hide()}).change();var c=a(".wc-bundled-items").find(".wc-bundled-item").get();c.sort(function(b,c){var d=parseInt(a(b).attr("rel")),e=parseInt(a(c).attr("rel"));return e>d?-1:d>e?1:0}),a(c).each(function(b,c){a(".wc-bundled-items").append(c)}),a(".wc-bundled-items").sortable({items:".wc-bundled-item",cursor:"move",axis:"y",handle:"h3",scrollSensitivity:40,forcePlaceholderSize:!0,helper:"clone",opacity:.65,placeholder:"wc-metabox-sortable-placeholder",start:function(a,b){b.item.css("background-color","#f6f6f6")},stop:function(a,c){c.item.removeAttr("style"),b()}}),a("#bundled_product_data .expand_all").click(function(){return a(this).closest(".wc-metaboxes-wrapper").find(".wc-metabox > .item-data").show(),!1}),a("#bundled_product_data .close_all").click(function(){return a(this).closest(".wc-metaboxes-wrapper").find(".wc-metabox > .item-data").hide(),!1})}a(".bundle_stock_msg").insertBefore("._manage_stock_field"),a("body").on("woocommerce-product-type-change",function(b,c){"bundle"==c?(a("input#_downloadable").prop("checked",!1),a("input#_virtual").removeAttr("checked"),a(".show_if_simple").show(),a(".show_if_external").hide(),a(".show_if_bundle").show(),a("input#_downloadable").closest(".show_if_simple").hide(),a("input#_virtual").closest(".show_if_simple").hide(),a("input#_manage_stock").change(),a("input#_per_product_pricing_active").change(),a("input#_per_product_shipping_active").change(),a("#_nyp").change()):a(".show_if_bundle").hide()}),a("select#product-type").change(),a("input#_per_product_shipping_active").change(function(){"bundle"==a("select#product-type").val()&&(a("input#_per_product_shipping_active").is(":checked")?(a(".show_if_virtual").show(),a(".hide_if_virtual").hide(),a(".shipping_tab").hasClass("active")&&a("ul.product_data_tabs li:visible").eq(0).find("a").click()):(a(".show_if_virtual").hide(),a(".hide_if_virtual").show()))}).change(),a("input#_per_product_pricing_active").change(function(){"bundle"==a("select#product-type").val()&&(a(this).is(":checked")?(a("#_regular_price").val(""),a("#_sale_price").val(""),a("._tax_class_field").closest(".options_group").hide(),a(".pricing").hide(),a("#bundled_product_data .wc-bundled-item .item-data .discount input.bundle_discount").each(function(){a(this).attr("disabled",!1)})):(a("._tax_class_field").closest(".options_group").show(),a("#_nyp").is(":checked")||a(".pricing").show(),a("#bundled_product_data .wc-bundled-item .item-data .discount input.bundle_discount").each(function(){a(this).attr("disabled","disabled")})))}).change(),a("#_nyp").change(function(){"bundle"==a("select#product-type").val()&&(a("#_nyp").is(":checked")?(a("input#_per_product_pricing_active").prop("checked",!1),a(".bundle_pricing").hide()):a(".bundle_pricing").show(),a("input#_per_product_pricing_active").change())}).change(),c(),a(".save_bundle").on("click",function(){a("#bundled_product_data").block({message:null,overlayCSS:{background:"#fff url("+woocommerce_admin_meta_boxes.plugin_url+"/assets/images/ajax-loader.gif) no-repeat center",opacity:.6}}),a(".wc-bundled-items .wc-bundled-item").find("*").off();var b={post_id:woocommerce_admin_meta_boxes.post_id,data:a("#bundled_product_data").find("input, select, textarea").serialize(),action:"woocommerce_product_bundles_save",security:a("#wc_save_bundle_nonce").val()};a.post(woocommerce_admin_meta_boxes.ajax_url,b,function(b){var d=window.location.toString();d=d.replace("post-new.php?","post.php?post="+woocommerce_admin_meta_boxes.post_id+"&action=edit&"),a.get(d,function(d){a(".wc-bundle-metaboxes-wrapper").html(a(d).find("#wc-bundle-metaboxes-wrapper-inner").parent().html()),a(".wc-bundled_products .bundled_products_selector").html(a(d).find("select#bundled_ids").parent().html()),c(),a(".wc-bundle-metaboxes-wrapper").find(".wc-metabox-content").hide(),a("input#_per_product_pricing_active").change(),a(".wc-bundle-metaboxes-wrapper .tips, .wc-bundle-metaboxes-wrapper .help_tip").tipTip({attribute:"data-tip",fadeIn:50,fadeOut:50,delay:200}),a(".wc-bundle-metaboxes-wrapper select.chosen_select").chosen(),a(".wc-bundled_products select#bundled_ids").ajaxChosen({method:"GET",url:woocommerce_admin_meta_boxes.ajax_url,dataType:"json",afterTypeDelay:100,data:{action:"woocommerce_json_search_products",security:woocommerce_admin_meta_boxes.search_products_nonce}},function(b){var c={};return a.each(b,function(a,b){c[a]=b}),c}),b.length>0&&alert(b.join("\n\n")),a("#bundled_product_data").unblock()})},"json")})});